---
import type { Work } from "../data/works";

interface Props {
  work: Work;
}

const { work } = Astro.props;
const withBase = (path: string) => `${import.meta.env.BASE_URL}${path.replace(/^\//, "")}`;
---

<article class="card panel">
  <a class="card-main" href={withBase(`/works/${work.slug}`)} aria-label={`${work.title} の作品詳細へ`}>
    <img class="thumb" src={work.thumbnail} alt={`${work.title} サムネイル`} loading="lazy" />
    <p class="sense">{work.sense}</p>
    <h3>{work.title}</h3>
    <p class="tagline">{work.tagline}</p>
    <p class="muted">{work.highlight}</p>
  </a>
  <div class="action-grid">
    <a class="action-card" href={withBase(`/works/${work.slug}`)}>
      <span class="label">作品詳細</span>
      <span class="meta">あらすじ・制作情報へ</span>
    </a>
    <a class="action-card" href={withBase(`/novels/${work.novelSlug}`)}>
      <span class="label">小説を読む</span>
      <span class="meta">本文ページへ</span>
    </a>
  </div>
</article>

<style>
  .card {
    display: grid;
    gap: 0.7rem;
  }

  .card-main {
    display: grid;
    gap: 0.45rem;
    color: var(--text);
    text-decoration: none;
  }

  .card-main:visited {
    color: var(--text);
  }

  .card-main:hover {
    color: var(--text);
  }

  .card-main:focus-visible {
    outline: 3px solid var(--focus);
    outline-offset: 4px;
    border-radius: 14px;
  }

  .thumb {
    width: 100%;
    aspect-ratio: 16 / 9;
    border-radius: 14px;
    object-fit: cover;
    border: 1px solid color-mix(in oklab, var(--line) 80%, transparent);
    background: #0f1b2a;
  }

  .sense {
    margin: 0;
    color: var(--ok);
    letter-spacing: 0.08em;
    font-size: 0.78rem;
    font-weight: 700;
  }

  h3 {
    margin: 0.1rem 0 0;
    font-size: 1.35rem;
  }

  .tagline {
    margin: 0;
    font-size: 1.04rem;
  }

  .muted {
    margin: 0;
    font-size: 0.93rem;
  }

  .action-grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 0.7rem;
  }

  .action-card {
    display: grid;
    gap: 0.15rem;
    min-height: 70px;
    padding: 0.7rem 0.8rem;
    border-radius: 12px;
    border: 1px solid color-mix(in oklab, var(--line) 82%, transparent);
    background: #17273b;
    color: var(--text);
    text-decoration: none;
  }

  .action-card:visited,
  .action-card:hover {
    color: var(--text);
  }

  .action-card:hover {
    background: #233a54;
  }

  .label {
    font-weight: 700;
    font-size: 0.95rem;
  }

  .meta {
    font-size: 0.8rem;
    color: var(--muted);
  }

  @media (max-width: 520px) {
    .action-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
